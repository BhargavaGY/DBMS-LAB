CREATE DATABASE SUPPLIERDB;
USE SUPPLIERDB;

CREATE TABLE SUPPLIERS(SID INT, S_NAME VARCHAR(45), ADDRESS VARCHAR(50), PRIMARY KEY(SID));
DESC SUPPLIERS;
CREATE TABLE PARTS(PID INT, P_NAME VARCHAR(45), COLOR VARCHAR(45), PRIMARY KEY(PID));
DESC PARTS;
CREATE TABLE CATALOG(SID INT, PID INT, COST REAL, PRIMARY KEY(SID, PID),
	FOREIGN KEY(SID) REFERENCES SUPPLIERS(SID),
    FOREIGN KEY(PID) REFERENCES PARTS(PID));
    
DESC CATALOG;

INSERT INTO SUPPLIERS(SID, S_NAME, ADDRESS) VALUES
	(1001, 'CLASSMATE', 'MUMBAI'),
    (1002, 'FLAIR', 'DELHI'),
    (1003, 'DELL', 'BANGALORE'),
    (1004, 'DOMZ', 'KOLKATTA'),
    (1005, 'SAMSUNG', 'BANGALORE');
SELECT * FROM SUPPLIERS;

INSERT INTO PARTS(PID, P_NAME, COLOR) VALUES
	(2001, 'BOOK', 'WHITE'),
    (2002, 'PEN', 'BLACK'),
    (2003, 'LAPTOP','SILVER'),
    (2004, 'PENCIL', 'RED'),
    (2005, 'MOBILE', 'GREEN');
SELECT * FROM PARTS;
INSERT INTO PARTS(PID, P_NAME, COLOR) VALUES
	(2006, 'CHARGER', 'WHITE'),
    (2007, 'IPAD', 'BLACK'),
    (2008, 'ERASER', 'BLUE'),
    (2009, 'SCALE', 'WHITE');

INSERT INTO CATALOG(SID, PID, COST) VALUES
	(1001, 2001, 40),
    (1002, 2002, 20),
    (1002, 2009, 5),
    (1003, 2003, 35000),
    (1003, 2007, 18000),
    (1004, 2004, 10),
    (1004, 2008, 5),
    (1005, 2005, 10000),
    (1005, 2006, 500);
SELECT * FROM CATALOG;

-- QUERY1 
SELECT P.PID, P.P_NAME 
FROM PARTS P, CATALOG C
WHERE C.PID = P.PID;

-- QUERY2
SELECT S.S_NAME 
FROM SUPPLIERS S
WHERE S.SID = ANY(SELECT C.SID
				FROM CATALOG C
                GROUP BY C.SID
                HAVING COUNT(*) = (SELECT COUNT(*)
								FROM PARTS));
